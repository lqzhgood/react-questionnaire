"use strict";(self.webpackChunkreact_questionnaire=self.webpackChunkreact_questionnaire||[]).push([[18],{80154:function(e,n,i){i.r(n),i.d(n,{default:function(){return Xe}});var t=i(72791),r=i(59434),s=i(83825),c=i(70675),a="Edit_container__Tqkn8",l="Edit_content-wrapper__z9jTk",o="Edit_content__04S-h",d="Edit_left__O0fnH",u="Edit_main__pg+Pv",x="Edit_canvas-wrapper__HPY6j",j="Edit_right__Sagq7",f=i(4942),Z=i(1413),m=i(34664),h=i(14692),p=i(42573),_=i(37404),v="EditCanvas_canvas__3Iiwc",C="EditCanvas_component-wrapper__iX0Nj",P="EditCanvas_selected__aWXC2",k="EditCanvas_locked__HPMf7",I="EditCanvas_component__6Dh6W",y=i(81694),N=i.n(y),g=i(25216),E=i(43893),b=i(80184);var L=function(e){var n=e.children,i=e.items,t=e.onDragEnd,r=(0,g.Dy)((0,g.VT)(g.MA,{activationConstraint:{distance:8}}));return(0,b.jsx)(g.LB,{sensors:r,collisionDetection:g.pE,onDragEnd:function(e){var n=e.active,r=e.over;if(r&&n.id!==r.id){var s=i.findIndex((function(e){return e.id===n.id})),c=i.findIndex((function(e){return e.id===r.id}));t(s,c)}},children:(0,b.jsx)(E.Fo,{items:i,strategy:E.qw,children:n})})},w=i(68218),T=function(e){var n=e.id,i=e.children,t=(0,E.nB)({id:n}),r=t.attributes,s=t.listeners,c=t.setNodeRef,a=t.transform,l=t.transition,o={transform:w.ux.Transform.toString(a),transition:l};return(0,b.jsx)("div",(0,Z.Z)((0,Z.Z)((0,Z.Z)({ref:c,style:o},r),s),{},{id:n,children:i}))};function H(e){var n=_.PS[e.type];return n?(0,b.jsx)(n.Component,(0,Z.Z)({},e.props)):(0,b.jsx)(m.Z,{description:"\u627e\u4e0d\u5230\u7ec4\u4ef6"})}var S=function(e){var n=e.loading,i=(0,r.I0)(),t=(0,p.Z)(),c=t.componentList,a=t.selectedId;return n?(0,b.jsx)("div",{style:{textAlign:"center",marginTop:"24px"},children:(0,b.jsx)(h.Z,{})}):(0,b.jsx)(L,{items:c.map((function(e){return(0,Z.Z)({id:e.fe_id},e)})),onDragEnd:function(e,n){i((0,s.U)({oldIndex:e,newIndex:n}))},children:(0,b.jsx)("div",{className:v,children:c.filter((function(e){return!e.isHidden})).map((function(e){var n,t=e.fe_id,r=e.isLocked,c=N()(C,(n={},(0,f.Z)(n,P,t===a),(0,f.Z)(n,k,r),n));return(0,b.jsx)(T,{id:t,children:(0,b.jsx)("div",{className:c,onClick:function(e){e.stopPropagation(),i((0,s.$i)(t))},children:(0,b.jsx)("div",{className:I,children:H(e)})})},t)}))})})},q=i(68961),z=i(91806),D=i(96230),F=i(16921),U="ComponentLib_wrap__eVdWL",M="ComponentLib_title__JmZzu",O="ComponentLib_componentWrap__gcw4v",K="ComponentLib_component__XQ6fN",W=i(25984),A=F.Z.Title,R=function(){var e=(0,r.I0)(),n=(0,t.useCallback)((function(n){var i=n.title,t=n.type,r=n.defaultProps;e((0,s.Tk)({fe_id:(0,W.x0)(),type:t,title:i,props:r}))}),[]);return(0,b.jsx)(b.Fragment,{children:_.I0.map((function(e){var i=e.groupName,t=e.components;return(0,b.jsxs)("div",{className:U,children:[(0,b.jsx)(A,{className:M,level:3,children:i}),t.map((function(e){var i=e.type,t=e.Component;return(0,b.jsx)("div",{className:O,onClick:function(){return n(e)},children:(0,b.jsx)("div",{className:K,children:(0,b.jsx)(t,{})})},i)}))]},i)}))})},V=i(29439),X="Layers_wrapper__9fXtz",$="Layers_title__NKpg9",B="Layers_selected__02vUL",G="Layers_handler__IxcY7",J="Layers_btn__EWtWa",Y=i(46988),Q=i(86005),ee=i(31773),ne=i(2641),ie=i(98272),te=i(38999),re=function(){var e=(0,p.Z)(),n=e.componentList,i=e.selectedId,c=(0,r.I0)(),a=(0,t.useState)(""),l=(0,V.Z)(a,2),o=l[0],d=l[1],u=(0,t.useCallback)((function(e){null!==e&&e.focus()}),[]);return(0,b.jsx)(L,{items:n.map((function(e){return(0,Z.Z)({id:e.fe_id},e)})),onDragEnd:function(e,n){return c((0,s.U)({oldIndex:e,newIndex:n}))},children:n.map((function(e){var t=e.fe_id,r=e.title,a=e.isHidden,l=e.isLocked,x=N()($,(0,f.Z)({},B,t===i));return(0,b.jsx)(T,{id:t,children:(0,b.jsxs)("div",{className:X,children:[(0,b.jsx)("div",{className:x,onClick:function(){return function(e){var t=n.find((function(n){return n.fe_id===e}));t&&!t.isHidden?e===i?d(e):(c((0,s.$i)(e)),d("")):Y.ZP.info("\u4e0d\u80fd\u9009\u4e2d\u9690\u85cf\u7ec4\u4ef6")}(t)},children:o===t?(0,b.jsx)(Q.Z,{ref:u,value:r,onChange:function(e){return function(e,n){var i=n.target.value.trim();i&&c((0,s.KL)({fe_id:e,opt:{title:i}}))}(t,e)},onPressEnter:function(){return d("")},onBlur:function(){return d("")}}):r}),(0,b.jsx)("div",{className:G,children:(0,b.jsxs)(ee.Z,{children:[(0,b.jsx)(ne.ZP,{className:a?"":J,shape:"circle",size:"small",icon:(0,b.jsx)(ie.Z,{}),type:a?"primary":"text",onClick:function(){return c((0,s.uN)({fe_id:t,isHidden:!a}))}}),(0,b.jsx)(ne.ZP,{className:l?"":J,shape:"circle",size:"small",icon:(0,b.jsx)(te.Z,{}),type:l?"primary":"text",onClick:function(){return c((0,s.ij)({fe_id:t}))}})]})})]})},t)}))})},se=function(){var e=[{key:"componentLib",label:(0,b.jsxs)("span",{children:[(0,b.jsx)(q.Z,{}),"\u7ec4\u4ef6\u5e93"]}),children:(0,b.jsx)("div",{children:(0,b.jsx)(R,{})})},{key:"layers",label:(0,b.jsxs)("span",{children:[(0,b.jsx)(z.Z,{}),"\u56fe\u5c42"]}),children:(0,b.jsx)(re,{})}];return(0,b.jsx)(D.Z,{items:e,defaultActiveKey:"componentLib"})},ce=i(13876),ae=i(92414),le=function(){return(0,b.jsx)(m.Z,{description:"\u672a\u9009\u4e2d\u7ec4\u4ef6"})},oe=function(){var e=(0,p.Z)(),n=e.selectedComponent,i=e.selectedId,t=(0,r.I0)();if(!n)return(0,b.jsx)(le,{});var c=n.type,a=n.props,l=n.isHidden,o=n.isLocked,d=_.PS[c];if(!d)return(0,b.jsx)(le,{});var u=d.PropsForm;return(0,b.jsx)(u,(0,Z.Z)((0,Z.Z)({},a),{},{onChange:function(e){t((0,s.gL)({fe_id:i,newProps:e}))},disabled:l||o}))},de=i(15401),ue=i(5353),xe=i(41853),je=function(){var e=(0,de.Z)(),n=(0,r.I0)(),i=ue.Z.useForm(),s=(0,V.Z)(i,1)[0];return(0,t.useEffect)((function(){s.setFieldsValue(e)}),[e]),(0,b.jsxs)(ue.Z,{layout:"vertical",initialValues:e,onValuesChange:function(e,i){n((0,xe.MP)(i))},form:s,children:[(0,b.jsx)(ue.Z.Item,{name:"title",label:"\u9875\u9762\u6807\u9898",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9875\u9762\u6807\u9898"}],children:(0,b.jsx)(Q.Z,{placeholder:"\u8bf7\u8f93\u5165\u9875\u9762\u6807\u9898"})}),(0,b.jsx)(ue.Z.Item,{name:"desc",label:"\u9875\u9762\u63cf\u8ff0",children:(0,b.jsx)(Q.Z,{placeholder:"\u8bf7\u8f93\u5165\u9875\u9762\u63cf\u8ff0"})}),(0,b.jsx)(ue.Z.Item,{name:"js",label:"\u9875\u9762\u4ee3\u7801",children:(0,b.jsx)(Q.Z.TextArea,{placeholder:"\u8bf7\u8f93\u5165 JS \u4ee3\u7801"})}),(0,b.jsx)(ue.Z.Item,{name:"css",label:"\u9875\u9762\u6837\u5f0f",children:(0,b.jsx)(Q.Z.TextArea,{placeholder:"\u8bf7\u8f93\u5165 CSS \u4ee3\u7801"})})]})},fe=function(e){return e.PROP="PROP",e.SETTING="SETTING",e}(fe||{}),Ze=function(){var e=(0,p.Z)().selectedId,n=[{key:fe.PROP,label:(0,b.jsxs)("span",{children:[(0,b.jsx)(ce.Z,{}),"\u5c5e\u6027"]}),children:(0,b.jsx)(oe,{})},{key:fe.SETTING,label:(0,b.jsxs)("span",{children:[(0,b.jsx)(ae.Z,{}),"\u9875\u9762\u8bbe\u7f6e"]}),children:(0,b.jsx)(je,{})}];return(0,b.jsx)(D.Z,{items:n,activeKey:e?fe.PROP:fe.SETTING})},me="EditHeader_header-wrapper__SUXpv",he="EditHeader_header__sKMKE",pe="EditHeader_left__gyoyh",_e="EditHeader_title__nHvvq",ve="EditHeader_main__NtJq3",Ce="EditHeader_right__ECftt",Pe=i(31752),ke=i(76864),Ie=i(57689),ye=i(82622),Ne=i(23414),ge=i(32426),Ee=i(40447),be=i(10430),Le=i(78030),we=i(50446),Te=i(61431),He=i(21465),Se=i(15297);function qe(){var e=document.activeElement;return e===document.body||!(null===e||void 0===e||!e.matches('div[role="button"]'))}var ze=function(){var e=(0,r.I0)();(0,He.Z)(["backspace","delete"],(function(){qe()&&e((0,s.c)())})),(0,He.Z)(["ctrl.c","meta.c"],(function(){qe()&&e((0,s.j$)())})),(0,He.Z)(["ctrl.v","meta.v"],(function(){qe()&&e((0,s.lb)())})),(0,He.Z)(["uparrow"],(function(){qe()&&e((0,s.qm)("up"))})),(0,He.Z)(["downarrow"],(function(){qe()&&e((0,s.qm)("down"))})),(0,He.Z)(["ctrl.z","meta.z"],(function(){qe()&&e(Se.zF.undo())}),{exactMatch:!0}),(0,He.Z)(["ctrl.y","meta.y"],(function(){qe()&&e(Se.zF.redo())}),{exactMatch:!0})},De=function(){var e=(0,r.I0)(),n=(0,p.Z)(),i=n.selectedId,t=n.selectedComponent,c=n.copiedComponent,a=n.componentList,l=(t||{}).isLocked,o=void 0!==l&&l;ze();var d=a.length-1,u=a.findIndex((function(e){return e.fe_id===i})),x=u<=0,j=u>=d;return(0,b.jsxs)(ee.Z,{children:[(0,b.jsx)(Te.Z,{title:"\u5220\u9664",children:(0,b.jsx)(ne.ZP,{shape:"circle",icon:(0,b.jsx)(ye.Z,{}),onClick:function(){return e((0,s.c)({fe_id:i}))}})}),(0,b.jsx)(Te.Z,{title:"\u9690\u85cf",children:(0,b.jsx)(ne.ZP,{shape:"circle",icon:(0,b.jsx)(ie.Z,{}),onClick:function(){return e((0,s.uN)({fe_id:i,isHidden:!0}))}})}),(0,b.jsx)(Te.Z,{title:o?"\u89e3\u9501":"\u9501\u5b9a",children:(0,b.jsx)(ne.ZP,{shape:"circle",icon:(0,b.jsx)(te.Z,{}),type:o?"primary":"default",onClick:function(){return e((0,s.ij)({fe_id:i}))}})}),(0,b.jsx)(Te.Z,{title:"\u590d\u5236",children:(0,b.jsx)(ne.ZP,{shape:"circle",icon:(0,b.jsx)(Ne.Z,{}),onClick:function(){return e((0,s.j$)({fe_id:i}))}})}),(0,b.jsx)(Te.Z,{title:"\u7c98\u8d34",children:(0,b.jsx)(ne.ZP,{shape:"circle",icon:(0,b.jsx)(ge.Z,{}),disabled:!c,onClick:function(){return e((0,s.lb)())}})}),(0,b.jsx)(Te.Z,{title:"\u4e0a\u79fb",children:(0,b.jsx)(ne.ZP,{shape:"circle",icon:(0,b.jsx)(Ee.Z,{}),disabled:x,onClick:function(){x||e((0,s.U)({oldIndex:u,newIndex:u-1}))}})}),(0,b.jsx)(Te.Z,{title:"\u4e0b\u79fb",children:(0,b.jsx)(ne.ZP,{shape:"circle",icon:(0,b.jsx)(be.Z,{}),disabled:j,onClick:function(){j||e((0,s.U)({oldIndex:u,newIndex:u+1}))}})}),(0,b.jsx)(Te.Z,{title:"\u64a4\u9500",children:(0,b.jsx)(ne.ZP,{shape:"circle",icon:(0,b.jsx)(Le.Z,{}),onClick:function(){e(Se.zF.undo())}})}),(0,b.jsx)(Te.Z,{title:"\u91cd\u505a",children:(0,b.jsx)(ne.ZP,{shape:"circle",icon:(0,b.jsx)(we.Z,{}),onClick:function(){e(Se.zF.redo())}})})]})},Fe=i(28641),Ue=i(18406),Me=i(12768),Oe=F.Z.Title,Ke=function(){var e=(0,de.Z)().title,n=(0,r.I0)(),i=(0,t.useState)(!1),s=(0,V.Z)(i,2),c=s[0],a=s[1];return(0,b.jsxs)(ee.Z,{align:"baseline",children:[c?(0,b.jsx)(Q.Z,{value:e,onChange:function(e){var i=e.target.value.trim();i&&n((0,xe.MP)({title:i}))},onBlur:function(){return a(!1)},onPressEnter:function(){return a(!1)}}):(0,b.jsx)(Oe,{className:_e,children:e}),(0,b.jsx)(ne.ZP,{type:"text",icon:(0,b.jsx)(Pe.Z,{}),onClick:function(){return a(!0)}})]})},We=function(){var e=(0,Ie.UO)().id,n=(0,p.Z)().componentList,i=(0,de.Z)(),r=(0,t.useMemo)((function(){return(0,Z.Z)((0,Z.Z)({},i),{},{componentList:n})}),[i,n]),s=(0,Fe.Z)((function(){return e?(0,Me.Hh)(e,r):Promise.reject("\u6ca1\u6709ID")}),{manual:!0}),c=s.loading,a=s.run;return(0,He.Z)(["ctrl.s","meta.s"],(function(e){e.preventDefault(),c||a()})),(0,Ue.Z)((function(){a()}),[i,n],{wait:3e4}),(0,b.jsx)(ne.ZP,{loading:c,onClick:a,children:"\u4fdd\u5b58"})},Ae=function(){var e=(0,Ie.UO)().id,n=(0,Ie.s0)(),i=(0,Fe.Z)((function(){return e?(0,Me.j4)(e,{isPublished:!0}):Promise.reject("\u6ca1\u6709ID")}),{manual:!0,onSuccess:function(){Y.ZP.success("\u53d1\u5e03\u6210\u529f"),n("/question/stat/".concat(e))}}),t=i.loading,r=i.run;return(0,b.jsx)(ne.ZP,{loading:t,onClick:r,type:"primary",children:"\u53d1\u5e03"})},Re=function(){var e=(0,Ie.s0)();return(0,b.jsx)("div",{className:me,children:(0,b.jsxs)("div",{className:he,children:[(0,b.jsx)("div",{className:pe,children:(0,b.jsxs)(ee.Z,{align:"baseline",children:[(0,b.jsx)(ne.ZP,{type:"link",icon:(0,b.jsx)(ke.Z,{}),onClick:function(){e(-1)},children:"\u8fd4\u56de"}),(0,b.jsx)(Ke,{})]})}),(0,b.jsx)("div",{className:ve,children:(0,b.jsx)(De,{})}),(0,b.jsx)("div",{className:Ce,children:(0,b.jsxs)(ee.Z,{children:[(0,b.jsx)(We,{}),(0,b.jsx)(Ae,{})]})})]})})},Ve=i(48478),Xe=function(){var e=(0,c.Z)().loading,n=(0,de.Z)().title;(0,Ve.Z)(n+"- \u95ee\u5377\u7f16\u8f91",{restoreOnUnmount:!0});var i=(0,r.I0)();return(0,b.jsxs)("div",{className:a,children:[(0,b.jsx)("div",{children:(0,b.jsx)(Re,{})}),(0,b.jsx)("div",{className:l,children:(0,b.jsxs)("div",{className:o,children:[(0,b.jsx)("div",{className:d,children:(0,b.jsx)(se,{})}),(0,b.jsx)("div",{className:u,onClick:function(){i((0,s.$i)(""))},children:(0,b.jsx)("div",{className:x,children:(0,b.jsx)(S,{loading:e})})}),(0,b.jsx)("div",{className:j,children:(0,b.jsx)(Ze,{})})]})})]})}}}]);
//# sourceMappingURL=Edit.88224159.chunk.js.map